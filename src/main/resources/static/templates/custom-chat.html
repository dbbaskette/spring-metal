<div ng-show="chatService.chatVisible && info.profiles.includes('llm')" id="custom-chat-wrapper"
     style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; width: 600px; height: 700px;
            background: white; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); display: flex; flex-direction: column;">

    <!-- Chat Header -->
    <div style="padding: 20px; border-bottom: 1px solid #eee; background: linear-gradient(135deg, #00d084 0%, #00b571 100%);
                border-radius: 12px 12px 0 0; color: white;">
        <h3 style="margin: 0; font-size: 20px;">ðŸŽ¸ Boneyard Assistant</h3>
        <small>Ask me anything about music!</small>
    </div>

    <!-- Messages Area -->
    <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 20px; background: #fafafa;">
        <div ng-repeat="message in chat.messages track by $index">
            <div ng-class="{'text-right': message.role === 'user'}" style="margin-bottom: 15px;">
                <div style="display: inline-block; max-width: 70%; padding: 12px 18px; border-radius: 18px; font-size: 16px; line-height: 1.5;"
                     ng-style="message.role === 'user' ?
                     {'background-color': '#00d084', 'color': 'white', 'margin-left': 'auto', 'text-align': 'left'} :
                     {'background-color': 'white', 'color': '#333', 'margin-right': 'auto', 'box-shadow': '0 1px 3px rgba(0,0,0,0.1)'}">
                    {{message.text}}
                </div>
            </div>
        </div>
        <div ng-if="chat.loading" style="text-align: left; margin-bottom: 15px;">
            <div style="display: inline-block; max-width: 70%; padding: 12px 18px; border-radius: 18px; font-size: 16px;
                        background-color: white; color: #666; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                <span>ðŸŽ¸ Thinking...</span>
            </div>
        </div>
    </div>

    <!-- Input Area -->
    <div style="padding: 20px; border-top: 1px solid #eee; background: white; border-radius: 0 0 12px 12px;">
        <div style="display: flex; gap: 12px;">
            <input type="text" ng-model="chat.input" placeholder="Type your message..." ng-disabled="chat.loading"
                   ng-keypress="$event.keyCode === 13 && sendMessage()"
                   style="flex: 1; padding: 12px 16px; border: 2px solid #ddd; border-radius: 24px; font-size: 16px;
                          outline: none; color: #333; font-weight: 500; background: white;">
            <button type="button" ng-click="sendMessage()" ng-disabled="chat.loading || !chat.input"
                    style="background: #00d084; color: white; border: none; border-radius: 50%;
                           width: 48px; height: 48px; font-size: 20px; cursor: pointer; transition: all 0.2s;
                           opacity: {{(chat.loading || !chat.input) ? '0.5' : '1'}};">
                âž¤
            </button>
        </div>
    </div>
</div>